From fbfa141845e770e1bedb0fadc7c5121aec2f04ff Mon Sep 17 00:00:00 2001
From: Clarence Ng <clarence.wyng@gmail.com>
Date: Tue, 22 Nov 2022 12:08:40 -0800
Subject: [PATCH] [core] OOM killer: adjust defaults

Signed-off-by: Clarence Ng <clarence.wyng@gmail.com>
---
 release/ray_release/cluster_manager/cluster_manager.py | 4 +++-
 src/ray/common/ray_config_def.h                        | 2 +-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/release/ray_release/cluster_manager/cluster_manager.py b/release/ray_release/cluster_manager/cluster_manager.py
index 599ac67b2..7fa5e6414 100644
--- a/release/ray_release/cluster_manager/cluster_manager.py
+++ b/release/ray_release/cluster_manager/cluster_manager.py
@@ -57,7 +57,9 @@ class ClusterManager(abc.ABC):
         ] = self.cluster_env["env_vars"].get("RAY_memory_monitor_interval_ms", "250")
         self.cluster_env["env_vars"][
             "RAY_memory_usage_threshold_fraction"
-        ] = self.cluster_env["env_vars"].get("RAY_memory_usage_threshold_fraction", "0.95")
+        ] = self.cluster_env["env_vars"].get(
+            "RAY_memory_usage_threshold_fraction", "0.95"
+        )
         self.cluster_env["env_vars"][
             "RAY_USAGE_STATS_EXTRA_TAGS"
         ] = f"test_name={self.test_name};smoke_test={self.smoke_test}"
diff --git a/src/ray/common/ray_config_def.h b/src/ray/common/ray_config_def.h
index 161bdfca8..660c8127c 100644
--- a/src/ray/common/ray_config_def.h
+++ b/src/ray/common/ray_config_def.h
@@ -97,7 +97,7 @@ RAY_CONFIG(uint64_t, memory_monitor_interval_ms, 250)
 /// This value is useful for larger host where the memory_usage_threshold_fraction could
 /// represent a large chunk of memory, e.g. a host with 64GB of memory and 0.9 threshold
 /// means 6.4 GB of the memory will not be usable.
-RAY_CONFIG(int64_t, min_memory_free_bytes, (int64_t) -1)
+RAY_CONFIG(int64_t, min_memory_free_bytes, (int64_t)-1)
 
 /// The TTL for when the task failure entry is considered
 /// eligble for garbage colletion.
-- 
2.25.1

